<IfModule mod_rewrite.c>
  RewriteEngine On

  # 1️⃣ Always allow robots.txt and sitemap.xml without rewrites
  RewriteRule ^(robots\.txt|sitemap\.xml)$ - [L]

  # 2️⃣ Redirect HTTP to HTTPS
  RewriteCond %{HTTPS} off
  RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]

  # 3️⃣ Serve index.html for root requests
  RewriteRule ^$ index.html [L]

  # 4️⃣ Remove .html from URLs entered explicitly
  RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /([^/]+/)*[^.]+\.html(\?[^\ ]*)?\ HTTP/
  RewriteRule ^(([^/]+/)*[^.]+)\.html$ /$1 [R=301,L]

  # 5️⃣ Route pretty URLs to their .html equivalents if present
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteCond %{DOCUMENT_ROOT}/$1.html -f
  RewriteRule ^(.+)$ $1.html [L]

  # 6️⃣ Custom 404 for non-matching requests
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteRule . /not-found.html [L]
</IfModule>

ErrorDocument 404 /not-found.html
AddType application/xml .xml
